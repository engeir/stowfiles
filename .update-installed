#!/bin/bash

# Updates a file called INSTALLED.md.
unameOut="$(uname -s)"
case "$unameOut" in
Linux*) machine=Linux ;;
Darwin*) machine=Mac ;;
CYGWIN*) machine=Cygwin ;;
MINGW*) machine=MinGw ;;
*)
    machine="UNKNOWN:${unameOut}"
    ;;
esac
# echo "$machine"
if [ "Mac" = "$machine" ]; then
    BREW="$(brew list)"
    CARGO="$(cargo install --list)"
    PIPX="$(pipx list | sed '1,2d' | sed 's/^   //')"
    echo "# Installed programs

## Brew

\`\`\`
$BREW
\`\`\`

## Cargo

\`\`\`
$CARGO
\`\`\`

## Pipx

\`\`\`
$PIPX
\`\`\`" >"./INSTALLED-mac.md"
fi
if [ "Linux" = "$machine" ]; then
    APT="$(dpkg --get-selections)"
    CARGO="$(cargo install --list)"
    PIPX="$(pipx list | sed '1,2d' | sed 's/^\s\s\s//')"
    FLAT="$(flatpak list)"
    SNAP="$(snap list)"
    echo "# Installed programs

\`\`\`
$APT
\`\`\`

## Cargo

\`\`\`
$CARGO
\`\`\`

## Pipx

\`\`\`
$PIPX
\`\`\`

## Flatpak

\`\`\`
$FLAT
\`\`\`

## Snap

\`\`\`
$SNAP
\`\`\`" >"./INSTALLED-linux.md"
fi
